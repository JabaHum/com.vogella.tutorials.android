== The Model View Presenter architecture for Android

The Android programming model encourages the creation of large activities or fragments.
These components typically contain both business and UI logic. 
This makes testing and maintenance of Android applications more difficult.

The Model View Presenter (MVP) architecture pattern tries to improve the application architecture  to improve its testability and to ease future maintenance.
The MVP pattern separates the _data model_, from a _view_ through a _presenter_.
The presenter handles the logic of the application.

image::mvp_overview.png[]

=== The view in MVP

The view in MVP includes the visual part of our app. 
This is not the same as the `View` class in Android, it usually implemented via fragments, activities or dialogs.
It contains only the UI and it does not contain any logic or knowledge of the data displayed.
In typical implementations the view components in MVP exports an interface that is used by the Presenter.
The presenter uses these interface methods to manipulate the view.
Example method names would be: `showProgressBar`, `updateData`.

=== The presenter in MVP

The presenter contains the logic when to update the view.
It also interacts with the model and fetches and transforms data from the model to update the view.
The presenter should not have, if possible, a dependency to the Android SDK, e.g., to the `Context` or `Activity`.


=== The model in MVP

Contains the data and the code to fetch and update the data. This part of MVP updates the database or communicate with a webserver.

=== Example

Image a small application which read data user data from Github.

You have an overview screen with the repositories of the selected user. 
If you click on the repository you would see details for this repository.

The contract would be defined via an interface.

[source,java]
----

import android.support.annotation.NonNull;

import java.util.List;

/**
 * This interface specifies the contract between the view and the presenter.
 */
public interface GitHubContract {

    interface View {

        void setProgressIndicator(boolean active);

        void showRepositories(List<String> repositories);

        void showAddRepository();

        void showRepositoryDetails(String repositoryId);
    }

    interface UserActionsListener {

        void loadRepositories(boolean forceUpdate);

        void addRepository();

        void openRepositoryDetails(@NonNull String repositoryId);
    }
}

----

In your own create method of the activity you instantiate the presenter.

[source,java]
----
 @Override
    public void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        // more code
        presenter = new GithubPresenter(parameter required for presenter..., this);
    }
----

Whenever the view needs to perform an operation on the presenter, it would call one of its methods.
If the presenter finishes, it would call back the view, via the defined interface methods.

